# Copyright Â© 2023- Gimlet Labs, Inc.
# All Rights Reserved.
#
# NOTICE:  All information contained herein is, and remains
# the property of Gimlet Labs, Inc. and its suppliers,
# if any.  The intellectual and technical concepts contained
# herein are proprietary to Gimlet Labs, Inc. and its suppliers and
# may be covered by U.S. and Foreign Patents, patents in process,
# and are protected by trade secret or copyright law. Dissemination
# of this information or reproduction of this material is strictly
# forbidden unless prior written permission is obtained from
# Gimlet Labs, Inc.
#
# SPDX-License-Identifier: Proprietary

load("@gml//bazel:gml_build_system.bzl", "gml_py_test", "no_sysroot")

gml_py_test(
    name = "test_client",
    srcs = ["test_client.py"],
    imports = [".."],
    deps = [
        "//src/api/python/gml",
        "//src/controlplane/logicalpipeline/lppb/v1:lppb_grpc_py_library",
        "//src/controlplane/logicalpipeline/lppb/v1:lppb_py_library",
        "//src/controlplane/model/mpb/v1:mpb_grpc_py_library",
        "//src/controlplane/model/mpb/v1:mpb_py_library",
        "@gml_api_pip//grpcio",
        "@pip//pytest",
    ],
)

gml_py_test(
    name = "test_compile",
    srcs = ["test_compile.py"],
    imports = [".."],
    # TODO(james): pytorch doesn't currently work in the sysroot.
    target_compatible_with = no_sysroot(),  # keep
    deps = [
        "//src/api/python/gml",
        "@gml_api_pip//torch",
        "@gml_api_pip//torch_mlir_gml",
        "@pip//pytest",
    ],
)
